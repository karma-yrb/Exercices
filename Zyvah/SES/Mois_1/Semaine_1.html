<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Zyvah SES - The Manager (Mois 1)</title>
    <style>
        :root {
            --bg: #0a0b14;
            --card: #141625;
            --accent: #00d2ff; /* Bleu Business/Manager */
            --accent-glow: rgba(0, 210, 255, 0.3);
            --success: #00ff88;
            --text: #ffffff;
            --text-dim: #8e96aa;
            --border: #232741;
            --font: 'Plus Jakarta Sans', system-ui, sans-serif;
        }

        * { box-sizing: border-box; margin: 0; padding: 0; font-family: var(--font); }
        body { background: var(--bg); color: var(--text); overflow: hidden; height: 100vh; }

        #app {
            width: 100%; max-width: 480px; height: 100vh;
            margin: auto; background: var(--card); overflow-y: auto;
            position: relative; display: flex; flex-direction: column;
            border-left: 1px solid var(--border); border-right: 1px solid var(--border);
        }

        /* HEADER DASHBOARD STYLE */
        .header { padding: 20px; border-bottom: 1px solid var(--border); background: linear-gradient(180deg, rgba(0,210,255,0.05) 0%, transparent 100%); }
        .stats-bar { display: flex; justify-content: space-between; font-size: 0.75rem; color: var(--accent); font-weight: 800; text-transform: uppercase; margin-bottom: 10px; }
        .bar-container { height: 4px; background: #000; border-radius: 2px; overflow: hidden; }
        .bar-fill { height: 100%; background: var(--accent); width: 0%; transition: 1s cubic-bezier(0.4, 0, 0.2, 1); box-shadow: 0 0 10px var(--accent-glow); }

        .view { display: none; padding: 24px; animation: fadeIn 0.4s ease-out; }
        .view.active { display: block; }

        /* MANAGER LOBBY */
        .manager-title { font-size: 1.8rem; font-weight: 800; margin-bottom: 8px; }
        .manager-intro { color: var(--text-dim); margin-bottom: 32px; line-height: 1.5; font-size: 0.95rem; }
        
        .mission-card {
            background: #1c1f35; border: 1px solid var(--border); padding: 20px;
            border-radius: 24px; display: flex; align-items: center; gap: 16px;
            margin-bottom: 16px; cursor: pointer; transition: 0.2s;
        }
        .mission-card:active { transform: scale(0.97); }
        .mission-card.locked { opacity: 0.4; filter: grayscale(1); cursor: not-allowed; }
        .mission-card.done { border-color: var(--success); background: rgba(0, 255, 136, 0.05); }
        
        .m-icon { 
            width: 48px; height: 48px; background: var(--border); border-radius: 16px; 
            display: flex; align-items: center; justify-content: center; font-size: 1.4rem;
        }
        .mission-card.active-mission .m-icon { background: var(--accent); color: #000; }
        .mission-card.done .m-icon { background: var(--success); color: #000; }

        .m-info h3 { font-size: 1rem; margin-bottom: 4px; }
        .m-info p { font-size: 0.75rem; color: var(--text-dim); }

        /* CONTENT */
        .step-label { font-size: 0.7rem; font-weight: 800; color: var(--accent); text-transform: uppercase; display: block; margin-bottom: 12px; }
        .content-title { font-size: 1.4rem; margin-bottom: 20px; line-height: 1.2; }
        .data-box { 
            background: #0a0b14; border: 1px solid var(--border); border-radius: 16px; 
            padding: 20px; margin: 20px 0; font-size: 0.95rem; line-height: 1.6;
            box-shadow: inset 0 2px 10px rgba(0,0,0,0.5);
        }
        
        /* INTERACTIVE OPTIONS */
        .option-grid { display: grid; gap: 12px; margin-top: 24px; }
        .opt-btn {
            background: #1c1f35; border: 1px solid var(--border); padding: 18px;
            border-radius: 16px; color: var(--text); text-align: left; font-size: 0.95rem;
            cursor: pointer; transition: 0.2s;
            width: 100%;
        }
        .opt-btn.correct { background: var(--success) !important; color: #000; font-weight: bold; border-color: var(--success); }
        .opt-btn.wrong { background: #ff4757; color: #fff; border-color: #ff4757; }

        .shake { animation: shake 0.4s ease-in-out; border-color: #ff4757 !important; }
        @keyframes shake {
            0%, 100% { transform: translateX(0); }
            25% { transform: translateX(-10px); }
            75% { transform: translateX(10px); }
        }

        .footer { position: sticky; bottom: 0; padding: 24px; background: var(--card); border-top: 1px solid var(--border); }
        .btn-main {
            width: 100%; padding: 20px; background: var(--accent); border: none; border-radius: 20px;
            color: #000; font-weight: 800; font-size: 1rem; text-transform: uppercase; cursor: pointer;
            box-shadow: 0 4px 15px var(--accent-glow); transition: 0.2s;
        }
        .btn-main:disabled { opacity: 0.3; filter: grayscale(1); }

        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
        .hidden { display: none !important; }
        b { color: var(--accent); }

        /* HINT SYSTEM */
        .hint-btn {
            background: transparent; border: 1px dashed var(--text-dim); color: var(--text-dim);
            padding: 8px 12px; border-radius: 10px; font-size: 0.8rem; cursor: pointer;
            margin-top: 10px; opacity: 0.7; transition: 0.3s;
        }
        .hint-btn:hover { opacity: 1; border-color: var(--accent); color: var(--accent); }
        .hint-box {
            background: rgba(255,255,255,0.05); padding: 12px; border-radius: 10px;
            margin-top: 10px; font-size: 0.9rem; border-left: 3px solid var(--accent);
            font-style: italic; animation: fadeInHint 0.3s ease;
        }
        @keyframes fadeInHint { from { opacity: 0; } to { opacity: 1; } }
    </style>
</head>
<body>

<div id="app">
    <div class="header">
        <div class="stats-bar">
            <span>The Manager v1.0</span>
            <span id="rank">NIVEAU : STAGIAIRE</span>
        </div>
        <div class="bar-container"><div id="p-bar" class="bar-fill"></div></div>
    </div>

    <!-- LOBBY -->
    <div id="lobby" class="view active">
        <h1 class="manager-title">Manager : Zyvah</h1>
        <p class="manager-intro">G√®re ta carri√®re comme une pro. Apprends comment fonctionne l'√©conomie pour dominer le march√© de la musique.</p>
        
        <div id="mission-list"></div>
    </div>

    <!-- CONTENT -->
    <div id="content" class="view">
        <span class="step-label" id="step-id">√âtape 01</span>
        <h2 id="step-title" class="content-title"></h2>
        <div id="step-body"></div>
    </div>

    <div class="footer hidden" id="footer">
        <button id="next" class="btn-main">CONTINUER</button>
    </div>
</div>

<script>
    const STORAGE_KEY = "zyvah_ses_w1";
    let state = JSON.parse(localStorage.getItem(STORAGE_KEY)) || { done: [], curDay: null, curStep: 0 };

    function save() { localStorage.setItem(STORAGE_KEY, JSON.stringify(state)); }

    const missionData = [
        {
            id: 1, title: "Mission 01 : Le March√© du Son", intro: "Ma√Ætrise les bases de l'Offre et de la Demande pour fixer tes prix.", icon: "üìà",
            steps: [
                { type: "msg", title: "Briefing Manager", body: `<p>Bienvenue dans le Game, Zyvah. Un <b>March√©</b>, c'est partout o√π des <b>vendeurs (Offre)</b> et des <b>acheteurs (Demande)</b> se rencontrent.</p><div class="data-box">Dans l'industrie musicale :<br>‚Ä¢ <b>Offre :</b> Artistes, labels, salles.<br>‚Ä¢ <b>Demande :</b> Fans, auditeurs.</div>` },
                { type: "quiz", title: "Identification", q: "Qui repr√©sente l'OFFRE sur le march√© du streaming ?", opts: ["Les fans", "Spotify", "Le prix"], a: 1, feed: "Exact ! Le vendeur propose le produit." },
                { type: "write", title: "Terminologie", q: "Quel mot d√©signe l'ensemble des vendeurs sur un march√© ?", a: "offre", hint: "C'est l'un des deux mots du titre de la mission (√ßa commence par 'O').", feed: "Correct. C'est le signal des producteurs." },
                { type: "msg", title: "La Loi de l'Offre", body: `<p>Plus le prix est √©lev√©, plus les producteurs veulent vendre.</p><div class="data-box"><b>Prix ‚¨ÜÔ∏è = Offre ‚¨ÜÔ∏è</b></div>` },
                { type: "msg", title: "La Loi de la Demande", body: `<p>Inversement pour les fans : si c'est trop cher, ils ach√®tent moins.</p><div class="data-box"><b>Prix ‚¨ÜÔ∏è = Demande ‚¨áÔ∏è</b></div>` },
                { type: "quiz", title: "M√©canisme", q: "Si le prix d'un disque passe de 20‚Ç¨ √† 50‚Ç¨, que fait la demande ?", opts: ["Elle augmente", "Elle diminue", "Rien"], a: 1, feed: "Loi de base : trop cher = moins de clients." },
                { type: "write", title: "Le Mot Cl√©", q: "Comment appelle-t-on le prix o√π l'offre est √©gale √† la demande ?", a: "equilibre", hint: "C'est quand les deux c√¥t√©s de la balance sont au m√™me niveau (9 lettres).", feed: "Le prix d'√©quilibre ! L√† o√π le march√© se vide." },
                { type: "quiz", title: "Choc de Demande", q: "Une trend TikTok rend ton son viral. La demande EXPLOSE. Le prix...", opts: ["Va descendre", "Va monter", "Va dispara√Ætre"], a: 1, feed: "Forte demande + stock limit√© = hausse des prix." },
                { type: "write", title: "Action Manager", q: "Si tu as trop de stock invendu, dois-tu monter ou baisser ton prix ?", a: "baisser", hint: "Pour attirer plus de clients (Demande), que fais-tu du prix ?", feed: "Baisser le prix attire la demande pour vider le stock." },
                { type: "challenge", title: "Validation 1", q: "Vrai ou Faux : Sur un march√©, le prix est fix√© uniquement par le vendeur ?", opts: ["VRAI", "FAUX"], a: 1, feed: "Faux ! L'acheteur (la demande) a aussi son mot √† dire par son comportement." }
            ]
        },
        {
            id: 2, title: "Mission 02 : Co√ªts & Profit", intro: "G√®re ton budget studio et calcule tes b√©n√©fices.", icon: "üí∏",
            steps: [
                { type: "msg", title: "Facteurs de Production", body: `<p>Pour produire, il faut :</p><div class="data-box">1. <b>Travail (L) :</b> Les humains.<br>2. <b>Capital (K) :</b> Les machines/outils.</div>` },
                { type: "quiz", title: "Inventaire", q: "L'ordinateur du studio, c'est quel facteur ?", opts: ["Travail", "Capital"], a: 1, feed: "C'est un outil, donc du Capital." },
                { type: "write", title: "Facteur Humain", q: "Comment appelle-t-on le facteur repr√©sent√© par l'ing√©nieur du son ?", a: "travail", hint: "C'est l'activit√© de l'humain pour produire (7 lettres).", feed: "C'est l'effort humain." },
                { type: "msg", title: "Co√ªt Fixe vs Variable", body: `<p>‚Ä¢ <b>Fixe :</b> Loyer (ne change pas avec la prod).<br>‚Ä¢ <b>Variable :</b> Mati√®re premi√®re (change selon la prod).</p>` },
                { type: "quiz", title: "Type de Co√ªt", q: "L'√©lectricit√© du studio qui tourne 24h/24 pour tes machines est un...", opts: ["Co√ªt fixe", "Co√ªt variable"], a: 1, feed: "Plus tu produis, plus tu consommes : c'est variable." },
                { type: "write", title: "Calcul Business", q: "CA = Prix x Quantit√©. Si tu vends 100 places √† 20‚Ç¨, quel est ton CA ?", a: "2000", hint: "Fais l'op√©ration 100 multipli√© par 20.", feed: "2000‚Ç¨ de chiffre d'affaires !" },
                { type: "msg", title: "La Profitabilit√©", body: `<p><b>Profit = CA - Co√ªts Totaux.</b> Ne confonds jamais l'argent qui rentre (CA) et ce qu'il te reste (Profit).</p>` },
                { type: "write", title: "Verdict Profit", q: "CA = 2000‚Ç¨. Co√ªts = 1500‚Ç¨. Quel est ton profit ?", a: "500", hint: "Fais la soustraction : 2000 - 1500.", feed: "Il te reste 500‚Ç¨ de gain r√©el." },
                { type: "quiz", title: "Productivit√©", q: "Produire plus avec autant de machines, c'est augmenter sa...", opts: ["Dette", "Productivit√©", "Taille"], a: 1, feed: "Efficacit√© maximum !" },
                { type: "challenge", title: "Alerte Faillite", q: "Ton CA est de 1000‚Ç¨ et tes Co√ªts sont de 1200‚Ç¨. Tu es en...", opts: ["B√©n√©fice", "D√©ficit"], a: 1, feed: "Attention ! Tu perds 200‚Ç¨. Il faut ajuster ton mod√®le." }
            ]
        },
        {
            id: 3, title: "Mission 03 : L'Effet de Marque", intro: "Pourquoi les gens ach√®tent TON son ? (Sociologie).", icon: "üß†",
            steps: [
                { type: "msg", title: "Socialisation", body: `<p>On apprend les go√ªts de notre entourage. C'est la <b>socialisation</b>.</p>` },
                { type: "quiz", title: "Groupe de Pairs", q: "Tes amis influencent tes go√ªts. C'est une socialisation...", opts: ["Verticale (parents)", "Horizontale (amis)"], a: 1, feed: "Exact. Entre personnes de m√™me niveau." },
                { type: "write", title: "Processus", q: "Comment appelle-t-on l'apprentissage des codes de la soci√©t√© ?", a: "socialisation", hint: "Le mot commence par 'S' et se termine par 'ition'. C'est le titre du bloc d'avant.", feed: "C'est √ßa. On devient un √™tre social." },
                { type: "msg", title: "Consommation Ostentatoire", body: `<p>Acheter pour 'montrer' son succ√®s. C'est l'effet Veblen.</p>` },
                { type: "quiz", title: "L'Effet Veblen", q: "Plus c'est cher, plus c'est d√©sir√© car c'est un signe de...", opts: ["Pauvret√©", "Luxe/Statut", "Tristesse"], a: 1, feed: "Le prix devient un signal social." },
                { type: "write", title: "Auteur", q: "Quel est le nom de l'effet quand la hausse du prix booste l'envie d'achat ?", a: "veblen", hint: "Un nom propre de 6 lettres commen√ßant par 'V'.", feed: "L'effet Veblen, pilier du luxe." },
                { type: "msg", title: "Capital Culturel", body: `<p>Tes dipl√¥mes et tes connaissances influencent ce que tu consommes.</p>` },
                { type: "quiz", title: "Habitus", q: "Nos habitudes de consommation li√©es √† notre milieu s'appellent l'...", opts: ["Habitus", "Hasard"], a: 0, feed: "Concept de Bourdieu : nos go√ªts sont ancr√©s en nous." },
                { type: "write", title: "Le Capital", q: "Outre l'argent, comment appelle-t-on le capital li√© aux dipl√¥mes ?", a: "culturel", hint: "C'est li√© √† la 'culture' (8 lettres).", feed: "Capital culturel. Tr√®s important pour le r√©seau." },
                { type: "challenge", title: "Marketing Pro", q: "Pour vendre un casque 'ultra-premium', tu dois...", opts: ["Le brader", "L'associer √† une image d'√©lite", "Le donner"], a: 1, feed: "Le marketing social joue sur l'appartenance √† un groupe." }
            ]
        },
        {
            id: 4, title: "Mission 04 : Guerre des Plateformes", intro: "Spotify, Apple, Deezer... Ma√Ætrise la concurrence.", icon: "‚öîÔ∏è",
            steps: [
                { type: "msg", title: "Structures de March√©", body: `<p>Trois types : Monopole (1), Oligopole (quelques-uns), Concurrence (beaucoup).</p>` },
                { type: "quiz", title: "Streaming", q: "Le march√© du streaming (Spotify, Apple, Deezer) est un...", opts: ["Monopole", "Oligopole", "Bazar"], a: 1, feed: "Quelques gros acteurs = Oligopole." },
                { type: "write", title: "Le Seul", q: "Comment appelle-t-on une entreprise SEULE sur son march√© ?", a: "monopole", hint: "Prefixe 'Mono-' (un seul).", feed: "Le roi du march√©." },
                { type: "msg", title: "Pouvoir de March√©", body: `<p>Un monopole peut fixer ses prix librement. C'est dangereux pour le client.</p>` },
                { type: "write", title: "Le Danger", q: "Comment appelle-t-on l'accord secret entre entreprises pour monter les prix ?", a: "cartel", hint: "Un mot de 6 lettres commen√ßant par 'C'. (Comme dans les films sur les trafics, mais pour le prix).", feed: "Un cartel (ou entente). C'est ill√©gal !" },
                { type: "quiz", title: "R√©gulation", q: "Qui surveille que les entreprises ne trichent pas sur la concurrence ?", opts: ["La police locale", "L'Autorit√© de la Concurrence", "Personne"], a: 1, feed: "L'√âtat r√©gule pour prot√©ger les prix." },
                { type: "msg", title: "Sortir du lot", body: `<p>Pour √©viter la guerre des prix, il faut se <b>diff√©rencier</b> (style unique).</p>` },
                { type: "write", title: "Strat√©gie", q: "Le fait de cr√©er un produit diff√©rent de ses concurrents s'appelle la...", a: "differenciation", hint: "Un mot long qui vient de 'diff√©rent' (15 lettres).", feed: "Exact. Tu deviens unique." },
                { type: "quiz", title: "Innovation", q: "L'innovation permet de cr√©er un...", opts: ["Petit monopole temporaire", "Grand d√©sordre"], a: 0, feed: "Schumpeter : l'innovation est le moteur de l'√©co." },
                { type: "challenge", title: "Droit du March√©", q: "Vrai ou Faux : Un monopole peut legalement fixer un prix de 1 million ‚Ç¨ pour un caf√© ?", opts: ["Oui, s'il n'y a pas d'autre choix", "Non, l'Etat peut intervenir"], a: 1, feed: "L'abus de position dominante est sanctionn√©." }
            ]
        },
        {
            id: 5, title: "Mission 05 : L'Examen Final", intro: "Prouve que tu es la meilleure Manager de l'ann√©e !", icon: "üèÜ",
            steps: [
                { type: "msg", title: "CEO Mode", body: `<p>Zyvah, c'est l'heure. Plus de briefing. Saisie tes d√©cisions.</p>` },
                { type: "write", title: "Q1 : Market", q: "Si la Demande > Offre, le prix va-t-il monter ou descendre ?", a: "monter", hint: "Plus de monde veut le produit mais il y en a peu... le prix ?", feed: "P√©nurie = Hausse." },
                { type: "write", title: "Q2 : Facteur", q: "Machines + Batiments = Facteur ... ?", a: "capital", hint: "Le facteur 'K'.", feed: "Valid√©." },
                { type: "write", title: "Q3 : Social", q: "L'effet de prestige li√© au prix √©lev√© s'appelle l'effet ... ?", a: "veblen", hint: "Commence par 'V'.", feed: "Expertise confirm√©e." },
                { type: "quiz", title: "Q4 : Structure", q: "March√© avec une multitude de petits vendeurs :", opts: ["Monopole", "Concurrence Parfaite", "Cartel"], a: 1, feed: "L'atomicit√© du march√©." },
                { type: "write", title: "Q5 : Formule", q: "Comment s'appelle : CA - Co√ªts ?", a: "profit", feed: "L'essentiel du business." },
                { type: "quiz", title: "Q6 : Strat√©gie", q: "Investir dans la formation des employ√©s, c'est booster le...", opts: ["Capital financier", "Capital humain"], a: 1, feed: "Le savoir est une richesse." },
                { type: "write", title: "Q7 : Illegal", q: "Nom du groupement d'entreprises qui s'entendent sur les prix :", a: "cartel", feed: "Interdit par la loi." },
                { type: "write", title: "Q8 : Psycho", q: "Le processus par lequel on apprend les normes :", a: "socialisation", feed: "La base de la sociologie." },
                { type: "quiz", title: "Q9 : Risque", q: "Si tes co√ªts > CA, tu es en...", opts: ["D√©ficit", "B√©n√©fice"], a: 0, feed: "Zone de danger." },
                { type: "challenge", title: "VERDICT FINAL", q: "Peut-on dire que le March√© est toujours parfait ?", opts: ["OUI", "NON (d√©faillances)"], a: 1, feed: "F√âLICITATIONS CEO ! Tu ma√Ætrises les rouages du syst√®me. Le contrat est sign√©. üñãÔ∏è" }
            ]
        }
    ];

    const ui = {
        lobby: document.getElementById('lobby'),
        content: document.getElementById('content'),
        list: document.getElementById('mission-list'),
        bar: document.getElementById('p-bar'),
        rank: document.getElementById('rank'),
        foot: document.getElementById('footer'),
        next: document.getElementById('next'),
        title: document.getElementById('step-title'),
        body: document.getElementById('step-body'),
        sId: document.getElementById('step-id')
    };

    function init() {
        renderLobby();
        updateProgress();
        ui.next.onclick = () => {
            const m = missionData.find(d => d.id === state.curDay);
            if (state.curStep < m.steps.length - 1) {
                state.curStep++;
                renderStep();
            } else {
                finish();
            }
            save();
        };
    }

    function updateProgress() {
        const perc = Math.round((state.done.length / missionData.length) * 100);
        ui.bar.style.width = perc + "%";
        if (perc >= 20) ui.rank.innerText = "NIVEAU : ASSISTANT";
        if (perc >= 60) ui.rank.innerText = "NIVEAU : MANAGER";
        if (perc === 100) ui.rank.innerText = "NIVEAU : CEO";
    }

    function renderLobby() {
        ui.lobby.classList.add('active');
        ui.content.classList.remove('active');
        ui.foot.classList.add('hidden');
        ui.list.innerHTML = "";
        missionData.forEach((m, i) => {
            const locked = i > 0 && !state.done.includes(missionData[i-1].id);
            const done = state.done.includes(m.id);
            const card = document.createElement('div');
            card.className = `mission-card ${locked ? 'locked' : ''} ${done ? 'done' : ''} ${!locked && !done ? 'active-mission' : ''}`;
            card.innerHTML = `
                <div class="m-icon">${m.icon}</div>
                <div class="m-info">
                    <h3>${m.title}</h3>
                    <p>${m.intro}</p>
                </div>
            `;
            if (!locked) card.onclick = () => start(m.id);
            ui.list.appendChild(card);
        });
    }

    function start(id) {
        state.curDay = id; state.curStep = 0;
        ui.lobby.classList.remove('active');
        ui.content.classList.add('active');
        ui.foot.classList.remove('hidden');
        renderStep();
    }

    function renderStep() {
        const m = missionData.find(d => d.id === state.curDay);
        const s = m.steps[state.curStep];
        ui.sId.innerText = `Mission ${m.id} ‚Ä¢ √âtape ${state.curStep + 1}`;
        ui.title.innerText = s.title;
        ui.next.disabled = ['quiz', 'challenge', 'write'].includes(s.type);
        ui.next.innerText = (state.curStep === m.steps.length - 1) ? "VALIDER LA MISSION" : "SUIVANT";

        if (s.type === 'msg') {
            ui.body.innerHTML = s.body;
        } else if (s.type === 'write') {
            ui.body.innerHTML = `<p style="margin-bottom:20px">${s.q}</p>`;
            const container = document.createElement('div');
            
            const input = document.createElement('input');
            input.type = "text";
            input.placeholder = "Ta r√©ponse de Manager...";
            input.className = "opt-btn";
            input.style.cursor = "text";
            input.style.background = "rgba(0,0,0,0.1)";
            
            const actionContainer = document.createElement('div');
            actionContainer.style.display = "flex";
            actionContainer.style.flexDirection = "column";
            actionContainer.style.gap = "10px";

            const checkBtn = document.createElement('button');
            checkBtn.className = "btn-main";
            checkBtn.style.marginTop = "10px";
            checkBtn.innerText = "V√âRIFIER LES DONN√âES";
            
            container.appendChild(input);
            container.appendChild(actionContainer);
            actionContainer.appendChild(checkBtn);

            if (s.hint) {
                const hBtn = document.createElement('button');
                hBtn.className = "hint-btn";
                hBtn.innerText = "üí° INDICE";
                const hBox = document.createElement('div');
                hBox.className = "hint-box hidden";
                hBox.innerText = s.hint;
                hBtn.onclick = () => hBox.classList.toggle('hidden');
                actionContainer.appendChild(hBtn);
                actionContainer.appendChild(hBox);
            }

            ui.body.appendChild(container);

            input.onkeydown = (e) => { if (e.key === 'Enter') checkBtn.click(); };
            
            checkBtn.onclick = () => {
                const userVal = input.value.trim().toLowerCase()
                    .normalize("NFD").replace(/[\u0300-\u036f]/g, ""); // Normalisation accents
                const cleanS = s.a.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g, "");
                
                if (userVal === cleanS) {
                    input.disabled = true;
                    checkBtn.disabled = true;
                    input.style.borderColor = "var(--success)";
                    const f = document.createElement('p');
                    f.style.marginTop = "15px"; f.style.color = "var(--success)";
                    f.innerHTML = `<b>‚úì ANALYSE VALID√âE :</b> ${s.feed}`;
                    ui.body.appendChild(f);
                    ui.next.disabled = false;
                } else {
                    input.classList.add('shake');
                    setTimeout(() => input.classList.remove('shake'), 400);
                }
            };
        } else {
            ui.body.innerHTML = `<p style="margin-bottom:20px">${s.q}</p><div class="option-grid"></div>`;
            const grid = ui.body.querySelector('.option-grid');
            s.opts.forEach((o, i) => {
                const b = document.createElement('button');
                b.className = "opt-btn";
                b.innerText = o;
                b.onclick = () => {
                    if (i === s.a) {
                        b.classList.add('correct');
                        ui.next.disabled = false;
                        const f = document.createElement('p');
                        f.style.marginTop = "15px"; f.style.color = "var(--success)";
                        f.innerHTML = `<b>‚úì Correct :</b> ${s.feed}`;
                        ui.body.appendChild(f);
                        grid.querySelectorAll('button').forEach(btn => btn.disabled = true);
                    } else {
                        b.classList.add('wrong');
                        setTimeout(() => b.classList.remove('wrong'), 500);
                    }
                };
                grid.appendChild(b);
            });
        }
    }

    function finish() {
        if (!state.done.includes(state.curDay)) state.done.push(state.curDay);
        
        // Ecran de r√©ussite CEO
        ui.body.innerHTML = `
            <div style="text-align:center; padding: 40px 0;">
                <h2 style="color:var(--success); font-size: 2rem; margin-bottom: 15px;">MISSION ACCOMPLIE !</h2>
                <p style="color:var(--text-dim); margin-bottom: 30px;">Les chiffres sont excellents. Tes actionnaires sont ravis.</p>
                <button onclick="renderLobby()" class="btn-main" style="background:var(--success); color:#000;">RETOUR AU DASHBOARD</button>
            </div>
        `;
        ui.next.parentElement.classList.add('hidden');
        ui.title.innerText = "SESSION TERMIN√âE";
        state.curDay = null; updateProgress(); save();
    }

    init();
</script>

</body>
</html>
